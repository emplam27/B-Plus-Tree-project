# B+ Tree ν”„λ΅μ νΈ



C μ–Έμ–΄μ ν¬μΈν„°λ¥Ό μ‚¬μ©ν•μ—¬ B Treeμ™€ B+ Treeλ¥Ό κµ¬ν„ν•λ” ν”„λ΅μ νΈμ…λ‹λ‹¤.



## B Tree κµ¬ν„

Bottum-up λ°©μ‹μ„ κµ¬ν„



### 1. μ„±μ§

Mμ°¨ Btree
\1. λ…Έλ“λ” **([\*m\*/2] \*m\*)**κ°μ μμ‹μ„ κ°€μ§ μ μλ‹¤.
\2. λ…Έλ“μ—λ” **(([\*m\*/2]β’1) (\*m\*β’1))**κ°μ ν‚¤κ°€ ν¬ν•¨λ  μ μλ‹¤.

λ…Έλ“μ ν‚¤κ°€ xκ°λ©΄, μμ‹μ€ (x+1)κ°
μµμ†μ°¨μλ” μμ‹μ ν•ν•
μµμ†μ°¨μ tλΌλ©΄ m = 2t - 1μ„ λ§μ΅±ν•΄μ•Όν•¨
ex. μµμ†μ°¨μ 2λΌλ©΄ 3μ°¨ treeμ΄λ©°, keyμ ν•ν•μ€ 1



### 2. κ²€μƒ‰κ³Όμ •

κ²€μƒ‰μ€ λ£¨νΈ λ…Έλ“μ—μ„λ¶€ν„° ν•ν–¥μ‹μΌλ΅ μ΄λ£¨μ–΄μ§„λ‹¤.

κ²€μƒ‰ν•λ ¤λ” ν‚¤λ¥Ό k λΌκ³  ν•μ.

1. λ£¨νΈ λ…Έλ“μ—μ„ μ‹μ‘ν•μ—¬, λ…Έλ“μ μ²«λ²μ§Έ ν‚¤λ¥Ό kμ™€ λΉ„κµν•λ‹¤.
   λ§μ•½ kκ°€ λ…Έλ“μ μ²«λ²μ§Έ ν‚¤μ™€ κ°™λ‹¤λ©΄(`k = the first key of the node`),
   κ·Έ λ…Έλ“μ™€ μΈλ±μ¤λ¥Ό λ°ν™ν•λ‹¤.
2. λ§μ•½ ν„μ¬ κ²€μƒ‰ν•κ³  μλ” λ…Έλ“κ°€ leafλΌλ©΄, NULLμ„ λ°ν™ν•λ‹¤.
3. λ§μ•½ kκ°€ λ…Έλ“μ μ²«λ²μ§Έ ν‚¤λ³΄λ‹¤ μ‘λ‹¤λ©΄(`k < the first key of the root node`), μ™Όμ½ μμ‹μ—μ„ μ΄ ν‚¤λ¥Ό μ¬κ·€μ μΌλ΅ μ°Ύλ”λ‹¤.
4. λ§μ•½ ν„μ¬ λ…Έλ“μ— ν•λ‚ μ΄μƒμ ν‚¤κ°€ μκ³  kκ°€ ν„μ¬ λ…Έλ“μ μ²«λ²μ§Έ ν‚¤λ³΄λ‹¤ ν¬λ‹¤λ©΄(`k > the first key`), kλ¥Ό ν„μ¬ λ…Έλ“μ λ‹¤μ ν‚¤μ™€ λΉ„κµν•λ‹¤.

- λ§μ•½ kκ°€ λ‹¤μ ν‚¤λ³΄λ‹¤ μ‘λ‹¤λ©΄(`k < next key`), μ™Όμ½ μμ‹μ—μ„ μ΄ ν‚¤λ¥Ό μ°Ύλ”λ‹¤.
- λ§μ•½ kκ°€ λ‹¤μ ν‚¤λ³΄λ‹¤ ν¬λ‹¤λ©΄, μ¤λ¥Έμ½ μμ‹μ—μ„ μ΄ ν‚¤λ¥Ό μ°Ύλ”λ‹¤.

1. 1~4 κ³Όμ •μ„ λ¦¬ν”„μ— λ„λ‹¬ν•  λ•κΉμ§€ λ°λ³µν•λ‹¤.



### 3. μ‚½μ…κ³Όμ •

μ”μ†λ¥Ό μ‚½μ…ν•κΈ° μ„ν•΄μ„  **1. μ”μ† μ‚½μ…μ— μ μ ν• λ…Έλ“λ¥Ό κ²€μƒ‰**ν•κ³ , **2. ν•„μ”ν• κ²½μ°, λ…Έλ“λ¥Ό λ¶„ν• **ν•΄μ•Ό ν•λ‹¤
μ‚½μ…μ€ μƒν–¥μ‹μΌλ΅ μ΄λ£¨μ–΄μ§„λ‹¤.

1. νΈλ¦¬κ°€ λΉ„μ–΄μμΌλ©΄ λ£¨νΈ λ…Έλ“λ¥Ό ν• λ‹Ήν•κ³ , ν‚¤λ¥Ό μ‚½μ…ν•λ‹¤.

2. λ…Έλ“μ— λ„£μ„ μ μλ” ν‚¤ μλ¥Ό μ—…λ°μ΄νΈν•λ‹¤. (`count` λ³€μ ν™μ©)

3. μ‚½μ…ν•  μ μ ν• λ¦¬ν”„ λ…Έλ“λ¥Ό κ²€μƒ‰ν•λ‹¤.

4. λ…Έλ“κ°€ κ°€λ“ μ°¬ κ²½μ°, 4-aλ΅ κ°„λ‹¤.
   λ…Έλ“κ°€ κ°€λ“ μ• μ°¬ κ²½μ°, 4-bλ΅ κ°„λ‹¤.
   **4-a. μ„ κ³Όμ •μ—μ„ μ μ ν• λ…Έλ“ κ²€μƒ‰ν–λ”λ° λ…Έλ“κ°€ κ°€λ“μ°¬ κ²½μ°**
   \1. μ¤λ¦„μ°¨μμΌλ΅ μ”μ†λ¥Ό μ‚½μ…ν•λ‹¤.
   \2. κ·Έλ¬λ©΄ λ…Έλ“κ°€ λ‹΄μ„ μ μλ” κ°μλ¥Ό μ΄κ³Όν•΄μ„ λ…Έλ“μ— λ‹΄κ²¨μλ” μƒνƒμ΄λ―€λ΅, μ¤‘μ•™κ°’μ—μ„ λ¶„ν• ν•λ‹¤.
   \3. μ¤‘μ•™κ°’μ€ μ„μ½ λ…Έλ“λ΅ λ³΄λ‚΄κ³ , μ™Όμ½ ν‚¤λ“¤μ€ μ™Όμ½ μμ‹μΌλ΅, μ¤λ¥Έμ½ ν‚¤λ“¤μ€ μ¤λ¥Έμ½ μμ‹μΌλ΅ λ§λ“ λ‹¤.
   \4. λ¶€λ¨ λ…Έλ“λ¥Ό κ²€μ‚¬ν•΄μ„ λλ‹¤μ‹ κ°€λ“ μ°Όλ‹¤λ©΄, ν•΄λ‹Ή λ¶€λ¨λ…Έλ“μ—μ„λ¶€ν„° 4-a-2~4λ¥Ό λ°λ³µν•λ‹¤.
   **4-b. μ„ κ³Όμ •μ—μ„ μ μ ν• λ…Έλ“κ°€ κ°€λ“ μ• μ°¬ κ²½μ°**
   μ¤λ¦„μ°¨μμΌλ΅ μ‚½μ…ν•λ‹¤.

   

### 4. μ‚­μ κ³Όμ •

μ”μ†λ¥Ό μ‚­μ ν•κΈ° μ„ν•΄μ„  **1. μ‚­μ ν•  ν‚¤κ°€ μλ” λ…Έλ“ κ²€μƒ‰, 2. ν‚¤ μ‚­μ , 3. ν•„μ”ν• κ²½μ°, νΈλ¦¬ κ· ν• μ΅°μ •**μ„ ν•΄μ•Όν•λ‹¤.
μ‚­μ  κ³Όμ •μ„ μ΄ν•΄ν•κΈ° μ„ν•΄μ„  λ‘ κ°€μ§€ μ©μ–΄λ¥Ό μ•μ•„μ•Ό ν•λ‹¤.

- `inorder predecessor` : λ…Έλ“μ μ™Όμ½ μμ†μ—μ„ κ°€μ¥ ν° ν‚¤
- `inorder successor` : λ…Έλ“μ μ¤λ¥Έμ½ μμ†μ—μ„ κ°€μ¥ μ‘μ€ ν‚¤

#### π’΅ Case 1. μ‚­μ ν•  ν‚¤κ°€ λ¦¬ν”„μ— μλ” κ²½μ°

```python
if ν„μ¬ λ…Έλ“μ— ν‚¤κ°€ μµμ† ν‚¤μλ³΄λ‹¤ ν¬λ‹¤λ©΄:
	κ·Έλƒ¥ μ‚­μ ν•λ‹¤.
elif μ™Όμ½ ν•μ  λ…Έλ“μ ν‚¤κ°€ μµμ† ν‚¤μ μ΄μƒμ΄λΌλ©΄:
	1. μ™Όμ½ ν•μ λ¥Ό λ°©λ¬Έν•κ³ , μ™Όμ½ ν•μ  λ…Έλ“μ—μ„ κ°€μ¥ ν° ν‚¤λ¥Ό μ €μ¥ν•λ‹¤.(tmp)
	2. ν„μ¬ ν‚¤λ¥Ό μ‚­μ ν•λ‹¤.
	3. λ¶€λ¨ λ…Έλ“λ¥Ό ν„μ¬ μ„μΉλ΅ λ‚΄λ¦¬κ³ , tmpλ¥Ό λ¶€λ¨ λ…Έλ“λ΅ μ΄λ™μ‹ν‚¨λ‹¤.
elif μ¤λ¥Έμ½ ν•μ  λ…Έλ“μ ν‚¤κ°€ μµμ† ν‚¤μ μ΄μƒμ΄λΌλ©΄:
	1. μ¤λ¥Έμ½ ν•μ λ¥Ό λ°©λ¬Έν•κ³ , μ¤λ¥Έμ½ ν•μ  λ…Έλ“μ—μ„ κ°€μ¥ μ‘μ€ ν‚¤λ¥Ό μ €μ¥ν•λ‹¤.(tmp)
	2. ν„μ¬ ν‚¤λ¥Ό μ‚­μ ν•λ‹¤.
	3. λ¶€λ¨ λ…Έλ“λ¥Ό ν„μ¬ μ„μΉλ΅ λ‚΄λ¦¬κ³ , tmpλ¥Ό λ¶€λ¨ λ…Έλ“λ΅ μ΄λ™μ‹ν‚¨λ‹¤. 
elif λ¶€λ¨μ ν‚¤κ°€ μµμ†κ°μ μ΄μƒμ΄λ©΄ :
	λ¶€λ¨ν‚¤λ¥Ό μ™Όμ½ ν•μ  λ…Έλ“λ‘ λ³‘ν•©ν•λ‹¤.
	(λ¶€λ¨ν‚¤λ€ ν„μ¬ `index-1`λ²μ§Έ ν‚¤λ¥Ό μλ―Έν•λ‹¤.
	λ‹¨, 0λ² indexμΌ λ•, 0λ²μ§Έ λ¶€λ¨ν‚¤λ΅ μ²λ¦¬ν•λ‹¤.)
else (λ¶€λ¨ λ…Έλ“μ ν‚¤κ°€ μµμ†λ§νΌμ΄λΌλ©΄):
	ν‚¤λ¥Ό μ‚­μ ν•κ³ , λ¶€λ¨ λ…Έλ“λ¥Ό μ•„λλ΅ λ‚΄λ¦¬κ³ , case3μ 2λ² κ³Όμ •μΌλ΅ μ΄λ™ν•λ‹¤.
```

#### π’΅ Case 2. μ‚­μ ν•  ν‚¤κ°€ λ‚΄λ¶€ λ…Έλ“μ— μκ³ , λ…Έλ“λ‚ μμ‹μ— ν‚¤κ°€ μµμ† ν‚¤μλ³΄λ‹¤ λ§μ„ κ²½μ°

```python
if μμ‹μ΄ λ¦¬ν”„μΈ κ²½μ°:
	if κ·Έ μμ‹μ ν‚¤κ°€ μµμ† ν‚¤μ μ΄μƒμ΄λ©΄: 
    		ν‚¤λ¥Ό μ‚­μ ν• ν›„, κ·Έ μμ‹μ—μ„ κ°€μ¥ ν° κ°’μΌλ΅ μ‚­μ λ λ¶€λ¶„μ„ λ€μ²΄ν•λ‹¤.
     	elif λ‚΄ ν‚¤μκ°€ μµμ† ν‚¤μ μ΄μƒμ΄λ©΄:
            	ν„μ¬ ν‚¤λ¥Ό μ‚­μ ν• ν›„, λ‚΄ ν‚¤μ μμ‹ λ…Έλ“λ“¤μ„ λ³‘ν•©ν•λ‹¤. (μ™Όμ½μΌλ΅)
	else (λ‚μ™€ μμ‹ λ¨λ‘ μµμ† ν‚¤μμΈ κ²½μ°): 
    		case 3μΌλ΅ μ΄λ™ν•λ‹¤.

else (μμ‹μ΄ λ¦¬ν”„κ°€ μ•„λ‹ κ²½μ°):
	μ™Όμ½ μμ†μ inorder predecessor(λ¦¬ν”„)μ™€ ν„μ¬ ν‚¤μ μλ¦¬λ¥Ό λ°”κΎΌλ‹¤.
    	ν„μ¬ ν‚¤λ¥Ό μ‚­μ ν• ν›„, case 1μΌλ΅ μ΄λ™ν•λ‹¤.
```

#### π’΅ Case 3. μ‚­μ ν•  ν‚¤κ°€ λ‚΄λ¶€ λ…Έλ“μ— μκ³ , λ…Έλ“μ— ν‚¤κ°€ μµμ†λ§νΌ, λ…Έλ“μ μμ‹μ ν‚¤λ„ λ¨λ‘ μµμ†μΈ κ²½μ°

μ΄ κ²½μ°μ—λ” μ‚­μ ν•  ν‚¤κ°€ μλ” λ…Έλ“λ„ μµμ†, λ‚΄ μμ‹λ“¤λ„ μµμ†μ΄λ―€λ΅, ν‚¤λ¥Ό μ‚­μ ν•λ©΄ νΈλ¦¬μ λ†’μ΄κ°€ μ¤„μ–΄λ“ λ‹¤.

```python
1. μ–‘μ½ μμ‹μ„ λ³‘ν•©ν•μ—¬, tmpλ³€μμ— μ €μ¥ν•λ‹¤.
2. ν„μ¬ ν‚¤λ¥Ό μ‚­μ ν•λ‹¤.
3. λ‚μ λ¶€λ¨ ν‚¤λ¥Ό μ™Όμ½ ν•μ  λ…Έλ“μ— λ¶™μΈλ‹¤.
4. μ΄ ν•μ  λ…Έλ“μ λ§μ§€λ§‰μ— tmpλ¥Ό λ¶™μΈλ‹¤.

if ν•μ  λ…Έλ“κ°€ μµλ€ ν‚¤μλ¥Ό λ„μ–΄κ°”λ‹¤λ©΄:
	μ‚½μ… μ—°μ‚°μ 4-aλ¥Ό μν–‰ν• ν›„, μΆ…λ£ν•λ‹¤.
else:
	if λ¶€λ¨ λ…Έλ“κ°€ λΉ„μ–΄μλ‹¤λ©΄:
    		λ¶€λ¨ λ…Έλ“μ— λ€ν•μ—¬ 2λ² κ³Όμ •λ¶€ν„° λ°λ³µν•λ‹¤.
	else: μΆ…λ£ν•λ‹¤.
```